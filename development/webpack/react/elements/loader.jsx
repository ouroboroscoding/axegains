/**
 * Loader
 *
 * Shows a loading screen
 *
 * @author Chris Nasr
 * @copyright OuroborosCoding
 * @created 2018-11-24
 */

// External modules
var React = require('react');

// Generic modules
var Events = require('../../generic/events.js');

// Make sure there isn't more than one Loader
var _loader = false;

// Create the Component
class Loader extends React.PureComponent
{
	constructor(props) {

		// Call the parent
		super(props);

		// If we already have a Loader
		if(_loader) {
			throw 'Can\'t have more than one Loader';
		}
		_loader = true;

		// Set the initial state
		this.state = {
			"visible": props.visible ? props.visible : false
		};

		// Bind methods
		this.loader = this.loader.bind(this);
	}

	componentWillMount() {
		// Track any show/hide loader events
		Events.add('loader', this.loader);
	}

	componentWillUnmount() {
		// Stop tracking any show/hide loader events
		Events.remove('loader', this.loader);
	}

	loader(show) {
		if(typeof show == 'undefined') {
			show = !this.state.visible;
		}
		this.setState({"visible":show})
	}

	render() {
		return (
			<div id="loader" style={{display: this.state.visible ? 'block' : 'none'}}>
				<div className="cell">
					<div className="content">
						<svg className="lds-gears" width="50%" height="50%" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
							<g transform="translate(50 50)">
								<g transform="translate(-19 -19) scale(0.6)">
									<g transform="rotate(158.188)">
										<animateTransform attributeName="transform" type="rotate" values="0;360" keyTimes="0;1" dur="2.6s" begin="0s" repeatCount="indefinite"></animateTransform>
										<path d="M37.3496987939662 -7 L47.3496987939662 -7 L47.3496987939662 7 L37.3496987939662 7 A38 38 0 0 1 31.359972760794346 21.46047782418268 L31.359972760794346 21.46047782418268 L38.431040572659825 28.531545636048154 L28.531545636048154 38.431040572659825 L21.46047782418268 31.359972760794346 A38 38 0 0 1 7.0000000000000036 37.3496987939662 L7.0000000000000036 37.3496987939662 L7.000000000000004 47.3496987939662 L-6.999999999999999 47.3496987939662 L-7 37.3496987939662 A38 38 0 0 1 -21.46047782418268 31.35997276079435 L-21.46047782418268 31.35997276079435 L-28.531545636048154 38.431040572659825 L-38.43104057265982 28.531545636048158 L-31.359972760794346 21.460477824182682 A38 38 0 0 1 -37.3496987939662 7.000000000000007 L-37.3496987939662 7.000000000000007 L-47.3496987939662 7.000000000000008 L-47.3496987939662 -6.9999999999999964 L-37.3496987939662 -6.999999999999997 A38 38 0 0 1 -31.35997276079435 -21.460477824182675 L-31.35997276079435 -21.460477824182675 L-38.431040572659825 -28.531545636048147 L-28.53154563604818 -38.4310405726598 L-21.4604778241827 -31.35997276079433 A38 38 0 0 1 -6.999999999999992 -37.3496987939662 L-6.999999999999992 -37.3496987939662 L-6.999999999999994 -47.3496987939662 L6.999999999999977 -47.3496987939662 L6.999999999999979 -37.3496987939662 A38 38 0 0 1 21.460477824182686 -31.359972760794342 L21.460477824182686 -31.359972760794342 L28.531545636048158 -38.43104057265982 L38.4310405726598 -28.53154563604818 L31.35997276079433 -21.4604778241827 A38 38 0 0 1 37.3496987939662 -6.999999999999995 M0 -23A23 23 0 1 0 0 23 A23 23 0 1 0 0 -23" fill="#000000"></path>
									</g>
								</g>
								<g transform="translate(19 19) scale(0.6)">
									<g transform="rotate(179.312)">
										<animateTransform attributeName="transform" type="rotate" values="360;0" keyTimes="0;1" dur="2.6s" begin="-0.1625s" repeatCount="indefinite"></animateTransform>
										<path d="M37.3496987939662 -7 L47.3496987939662 -7 L47.3496987939662 7 L37.3496987939662 7 A38 38 0 0 1 31.359972760794346 21.46047782418268 L31.359972760794346 21.46047782418268 L38.431040572659825 28.531545636048154 L28.531545636048154 38.431040572659825 L21.46047782418268 31.359972760794346 A38 38 0 0 1 7.0000000000000036 37.3496987939662 L7.0000000000000036 37.3496987939662 L7.000000000000004 47.3496987939662 L-6.999999999999999 47.3496987939662 L-7 37.3496987939662 A38 38 0 0 1 -21.46047782418268 31.35997276079435 L-21.46047782418268 31.35997276079435 L-28.531545636048154 38.431040572659825 L-38.43104057265982 28.531545636048158 L-31.359972760794346 21.460477824182682 A38 38 0 0 1 -37.3496987939662 7.000000000000007 L-37.3496987939662 7.000000000000007 L-47.3496987939662 7.000000000000008 L-47.3496987939662 -6.9999999999999964 L-37.3496987939662 -6.999999999999997 A38 38 0 0 1 -31.35997276079435 -21.460477824182675 L-31.35997276079435 -21.460477824182675 L-38.431040572659825 -28.531545636048147 L-28.53154563604818 -38.4310405726598 L-21.4604778241827 -31.35997276079433 A38 38 0 0 1 -6.999999999999992 -37.3496987939662 L-6.999999999999992 -37.3496987939662 L-6.999999999999994 -47.3496987939662 L6.999999999999977 -47.3496987939662 L6.999999999999979 -37.3496987939662 A38 38 0 0 1 21.460477824182686 -31.359972760794342 L21.460477824182686 -31.359972760794342 L28.531545636048158 -38.43104057265982 L38.4310405726598 -28.53154563604818 L31.35997276079433 -21.4604778241827 A38 38 0 0 1 37.3496987939662 -6.999999999999995 M0 -23A23 23 0 1 0 0 23 A23 23 0 1 0 0 -23" fill="#ffffff"></path>
									</g>
								</g>
							</g>
						</svg>
					</div>
				</div>
			</div>
		)
	}
}

// Export the component
module.exports = Loader;
